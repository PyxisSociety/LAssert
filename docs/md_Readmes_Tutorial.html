<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LAssert: Tutorial</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">LAssert
   </div>
   <div id="projectbrief">Unary test library in C</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Tutorial </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Unary test library in C, greatly inspired by <a href="https://github.com/catchorg/Catch2">Catch2</a>.</p>
<h2>Notes</h2>
<p>Some functionalities are not available on windows:</p><ul>
<li>making allocation functions return always <code>NULL</code></li>
<li>the <code>PERFORMANCE</code> macro</li>
</ul>
<h2>How to use it</h2>
<p>Here is a small tutorial devided in few steps:</p><ul>
<li><a href="#markdown-header-Configuration">Configuration of this tool</a> and some remarks</li>
<li><a href="#markdown-header-Simple-macros">Simple macros</a> you can use</li>
<li><a href="#markdown-header-Advanced-macros">Advanced macros</a> you can use</li>
<li><a href="#markdown-header-events">Events</a> that you can define</li>
<li><a href="#markdown-header-Disabling-allocation">Disabling allocation functions</a> to make them return <code>NULL</code> (not on Windows)</li>
<li><a href="#markdown-header-Performance">Performance testing</a> (not on Windows)</li>
</ul>
<h3>Configuration and remarks</h3>
<p>Some functionalities can be (de)activated by macros only (that need to be put before including LAssert) such as:</p><ul>
<li><b>LASSERT_MANUAL_MAIN</b>: providing a self define main</li>
<li><b>LASSERT_CUSTOM_ALLOC</b>: enabling (de)activation of allocation functions (making them work normally or always return <code>NULL</code>)</li>
</ul>
<p>The resulting program can have predefined parameters described bellow. If you used <b>LASSERT_MANUAL_MAIN</b>, you can still have this behavior by calling <code>LASSERT_PARAMETERS_INIT(argc, argv)</code>. Using <code>-h</code> option will show you all available parameters but will prevent the program from running the tests.</p>
<p>Default options are: -nt -c -out=consol -epsilon=1e-6 Some other functionalities can be (de)activated by macros <em>and</em> parameters such as:</p><ul>
<li><b>-[n]t</b> or <b>LASSERT_SECTION_TIME</b>: (de)activate timer functionality for sections</li>
<li><b>-[n]c</b> or <b>LASSERT_NO_COLOR</b>: (de)activate color in input</li>
<li><b>-out=[option]</b> or : set the output format. [option] can be one of the following:<ul>
<li><b>consol</b> (default behavior): standard output console with information about all test cases in all section</li>
<li><b>small</b> or <b>LASSERT_MINIMIZED_OUTPUT</b>: smaller output giving only information about sections and not details about their test cases</li>
<li><b>mini</b> or <b>LASSERT_SMALL_OUTPUT</b>: (stands for minimized) no details at all, it just give the percentage of succeeded test case in every sections (as a summarized result)</li>
<li><b>xml</b> or <b>LASSERT_XML_OUTPUT</b>: JUnit like XML is rendered in standard output</li>
</ul>
</li>
<li><b>-epsilon=[value]</b>, <b>LASSERT_EPSILON</b> or <code>LASSERT_set_epsilon(yourValue)</code>: set the accepted difference on floating point number comparison (value must be a strictly positive floating point number)</li>
<li><b>-seed=[value]</b>, <b>LASSERT_SEED</b> or <code>LASSERT_init_seed(yourSeed)</code>: set the seed to initialize random number (the function re initialize the random generator), default value use the <code>time(NULL)</code> function.</li>
</ul>
<p><b>NOTES:</b></p><ul>
<li>In auto main mode, the program will return the number of section on failure.</li>
<li>In manual main mode, each call to <code>RUN_SECTION</code> returns 1 if the section failed due to an error, 2 if it failed due to a <code>NULL</code> pointer (call of <code>REQUIRE_NOT_NULL</code>) or 0 if all went well.</li>
<li>In manual main and minimized (or xml) output mode, you need to call <code>LASSERT_PRINT_OUTPUT()</code> to show the result. If you call this function in another mode, it will simply do nothing so you should call it either way.</li>
<li>In XML output mode, all user call to write things in standard and error outputs are locked. Forcedly unlocking will make this option unusable.</li>
</ul>
<h3>Simple macros</h3>
<p>The code below show all the simple macros you can use in LAssert : </p><div class="fragment"><div class="line"><span class="preprocessor">#define LASSERT_MAIN</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="LAssert_8h.html">LAssert.h</a>&quot;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div><div class="line"></div><div class="line">TEST_SECTION(Section1){</div><div class="line">    REQUIRE(1); <span class="comment">/* a succesful require */</span></div><div class="line"></div><div class="line">    <a class="code" href="LAssert_8h.html#a52a9de102c9503a0a99c8df2323d1c61">TEST_CASE</a>(Case1){</div><div class="line">        REQUIRE(0, <span class="stringliteral">&quot;error message %d&quot;</span>, 5); <span class="comment">/* an unsuccesful require resulting in an unsuccesful test case */</span></div><div class="line">        puts(<span class="stringliteral">&quot;This text will not be printed&quot;</span>);</div><div class="line">    }</div><div class="line"></div><div class="line">    <a class="code" href="LAssert_8h.html#a52a9de102c9503a0a99c8df2323d1c61">TEST_CASE</a>(<span class="stringliteral">&quot;case 2&quot;</span>){</div><div class="line">        REQUIRE(1);</div><div class="line">        puts(<span class="stringliteral">&quot;This text will be printed&quot;</span>);</div><div class="line">    }</div><div class="line">}</div><div class="line"></div><div class="line">TEST_SECTION(<span class="stringliteral">&quot;second section&quot;</span>){</div><div class="line">    <span class="keywordtype">int</span> * p = (<span class="keywordtype">int</span>*)malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div><div class="line"></div><div class="line">    REQUIRE_NOT_NULL(p, <span class="stringliteral">&quot;will be shown only if malloc failed&quot;</span>); <span class="comment">/* will fail if p is NULL, not the same error log as require if failed */</span></div><div class="line"></div><div class="line">    *p = 2;</div><div class="line"></div><div class="line">    free(p);</div><div class="line">    p = NULL;</div><div class="line"></div><div class="line">    REQUIRE_NOT_NULL(p);</div><div class="line">}</div><div class="line"></div><div class="line">TEST_SECTION(equal_test){</div><div class="line">    EQ( .3,.300000001);</div><div class="line"></div><div class="line">    <a class="code" href="LAssert_8h.html#a52a9de102c9503a0a99c8df2323d1c61">TEST_CASE</a>(should_failed){</div><div class="line">    EQ(.7,.6, <span class="stringliteral">&quot;it is not possible&quot;</span>);</div><div class="line">    }</div><div class="line"></div><div class="line">    EQ_EPS(.7, .6, .2);</div><div class="line">}</div><div class="line"></div><div class="line"><span class="preprocessor">#ifdef LASSERT_MANUAL_MAIN</span></div><div class="line"><span class="keywordtype">int</span> main(){</div><div class="line">    RUN_SECTION(Section1);</div><div class="line">    RUN_SECTION(Section2);</div><div class="line"></div><div class="line">    <span class="keywordflow">return</span> 0;</div><div class="line">}</div><div class="line"><span class="preprocessor">#endif</span></div></div><!-- fragment --><p> Here is what each macro means in case you did not guess :</p><ul>
<li><b>LASSERT_MAIN</b>: specify that the current file is the main file. You need one and only one file from all those compiled in the program to have this macro before <code><a class="el" href="LAssert_8h.html" title="header only Unitary Test Tools in C ">LAssert.h</a></code> inclusion.</li>
<li><b>TEST_SECTION</b>: define a section of test which can contain test cases</li>
<li><b>TEST_CASE</b>: define a test case</li>
<li><b>REQUIRE</b>: end the test case or test section in which it was called on fail</li>
<li><b>REQUIRE_NOT_NULL</b>: same as <b>REQUIRE</b> but with a different log message on fail</li>
<li><b>RUN_SECTION</b>: manually run a test section</li>
<li><b>EQ</b>: test if two numbers are equals (useful for floating point numbers)</li>
<li><b>EQ_EPS</b>: test if two numbers are equals (useful for floating point numbers) with a user define tolerated error</li>
</ul>
<p><b>NOTES:</b></p><ul>
<li>As you may have noticed, you can add formatted string like printf parameters to REQUIRE, REQUIRE_NOT_NULL and EQ macros. This formatted string will be shown only when the test will fail.</li>
<li>Sections and cases names can be either an identifier or a string</li>
</ul>
<p><em>WARNING:</em> On contrary to printf first argument, it has to be a string constant, not a variable (even variable constants are not allowed)</p>
<h3>Advanced macros</h3>
<p>The code below show all the other macros you can use in LAssert : </p><div class="fragment"><div class="line"><span class="preprocessor">#include LASSERT_MAIN</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="LAssert_8h.html">LAssert.h</a>&quot;</span></div><div class="line"></div><div class="line">TEST_SECTION(random_test){</div><div class="line">    <a class="code" href="LAssert_8h.html#a13a096d4b31febb9db165fe0d3b2c3c1">RAND_CASE</a>(first_random,tab,3,3,1,10,10,100){</div><div class="line">    puts(<span class="stringliteral">&quot;BEEEEGIN&quot;</span>);</div><div class="line">    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0;i &lt; 3; ++i){</div><div class="line">        printf(<span class="stringliteral">&quot;%d\n&quot;</span>,tab[i]);</div><div class="line">        REQUIRE(tab[i]);</div><div class="line">    }</div><div class="line">    putchar(<span class="charliteral">&#39;\n&#39;</span>);</div><div class="line">    }</div><div class="line"></div><div class="line">    <a class="code" href="LAssert_8h.html#a13a096d4b31febb9db165fe0d3b2c3c1">RAND_CASE</a>(should_failed,tab2,5,5,1){</div><div class="line">    }</div><div class="line"></div><div class="line">    <a class="code" href="LAssert_8h.html#a13a096d4b31febb9db165fe0d3b2c3c1">RAND_CASE</a>(fail_on_0, tab3, 4, 4, 0, 3){</div><div class="line">    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0; i &lt; 4; ++i)</div><div class="line">        REQUIRE(tab3[i]);</div><div class="line">    }</div><div class="line"></div><div class="line">    <a class="code" href="LAssert_8h.html#a0afce0c02ee5da842bcaa026e3c2b955">LASSERT_set_rand_function</a>(myRand);</div><div class="line">    <a class="code" href="LAssert_8h.html#a13a096d4b31febb9db165fe0d3b2c3c1">RAND_CASE</a>(selfDefineRandFunction, tab4, 1, 5, 0, 1000){</div><div class="line">        REQUIRE(!*tab4);</div><div class="line">    }</div><div class="line">}</div><div class="line"></div><div class="line">TEST_SECTION(range_test){</div><div class="line">    <a class="code" href="LAssert_8h.html#a7afbcd22f6153ec8a1c0d5b3a35d156c">RANGE_CASE</a>(should_succeed,tab,3,1,3,1){</div><div class="line">    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0; i &lt; 3; ++i)</div><div class="line">        printf(<span class="stringliteral">&quot;%d &quot;</span>,tab[i]);</div><div class="line">    putchar(<span class="charliteral">&#39;\n&#39;</span>);</div><div class="line">    }</div><div class="line"></div><div class="line">    <a class="code" href="LAssert_8h.html#a7afbcd22f6153ec8a1c0d5b3a35d156c">RANGE_CASE</a>(should_failed,tab2,3,1){</div><div class="line">    }</div><div class="line">}</div><div class="line"></div><div class="line">TEST_SECTION(<span class="stringliteral">&quot;values test&quot;</span>){</div><div class="line">    <span class="keywordtype">int</span> i[] = {1, 2, 3, 4};</div><div class="line"></div><div class="line">    <a class="code" href="LAssert_8h.html#a123cb848661e15153b4eadeef888a85c">VALUES_CASE</a>(<span class="stringliteral">&quot;should succeed&quot;</span>, <span class="keywordtype">int</span>, var, i){</div><div class="line">        REQUIRE(var, <span class="stringliteral">&quot;failed with value %d\n&quot;</span>, var);</div><div class="line">    }</div><div class="line"></div><div class="line">    i[3] = 0;</div><div class="line"></div><div class="line">    <a class="code" href="LAssert_8h.html#a123cb848661e15153b4eadeef888a85c">VALUES_CASE</a>(<span class="stringliteral">&quot;should fail&quot;</span>, <span class="keywordtype">int</span>, var, i){</div><div class="line">        REQUIRE(var, <span class="stringliteral">&quot;failed with value %d\n&quot;</span>, var);</div><div class="line">    }</div><div class="line">}</div><div class="line"></div><div class="line">TEST_SECTION(copy_test){</div><div class="line">    <span class="keywordtype">unsigned</span> i = 0;</div><div class="line"></div><div class="line">    <a class="code" href="LAssert_8h.html#a52a9de102c9503a0a99c8df2323d1c61">TEST_CASE</a>(should_succeed){</div><div class="line">    <a class="code" href="LAssert_8h.html#a790bb66eba671d4d6ab645888b2f7482">COPY</a>(<span class="keywordtype">unsigned</span>,i);</div><div class="line">    i = 2;</div><div class="line">    REQUIRE(i);</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* ONCE has to be put if there are test cases AND code not inside a test_case for the last one not to be done more than once */</span></div><div class="line">    puts(<span class="stringliteral">&quot;Display more than once&quot;</span>);</div><div class="line"></div><div class="line">    <a class="code" href="LAssert_8h.html#ae7f1b02d73e4ab5ffeccff67926574e0">ONCE</a> puts(<span class="stringliteral">&quot;A line displayed only once&quot;</span>);</div><div class="line"></div><div class="line">    <a class="code" href="LAssert_8h.html#ae7f1b02d73e4ab5ffeccff67926574e0">ONCE</a> {</div><div class="line">    puts(<span class="stringliteral">&quot;A block displayed only once&quot;</span>);</div><div class="line">    }</div><div class="line"></div><div class="line">    <a class="code" href="LAssert_8h.html#a52a9de102c9503a0a99c8df2323d1c61">TEST_CASE</a>(should_failed){</div><div class="line">    REQUIRE(i);</div><div class="line">    }</div><div class="line">}</div><div class="line"></div><div class="line">TEST_SECTION(logs){</div><div class="line">    <a class="code" href="LAssert_8h.html#ac4c7cfa0ccfc5d3efa3eb3cb1502fc0d">INFO</a>(<span class="stringliteral">&quot;COUCOU %s&quot;</span>, <span class="stringliteral">&quot;johnny&quot;</span>);</div><div class="line"></div><div class="line">    CHECK(0);</div><div class="line"></div><div class="line">    <a class="code" href="LAssert_8h.html#a52a9de102c9503a0a99c8df2323d1c61">TEST_CASE</a>(<span class="stringliteral">&quot;warning case&quot;</span>){</div><div class="line">        CHECK(0);</div><div class="line">        <a class="code" href="LAssert_8h.html#aabbe679a1c1297285a0beb6c0d17b42b">WARNING</a>(<span class="stringliteral">&quot;be careful&quot;</span>);</div><div class="line">        REQUIRE(0);</div><div class="line">        <a class="code" href="LAssert_8h.html#ac4c7cfa0ccfc5d3efa3eb3cb1502fc0d">INFO</a>(<span class="stringliteral">&quot;should not be printed&quot;</span>);</div><div class="line">    }</div><div class="line"></div><div class="line">    <a class="code" href="LAssert_8h.html#a6a97021f911e2f7ee359fe7773347ad5">ERROR</a>(<span class="stringliteral">&quot;oups&quot;</span>);</div><div class="line"></div><div class="line">    CHECK(0);</div><div class="line"></div><div class="line">    REQUIRE(0);</div><div class="line">}</div></div><!-- fragment --><p> Here is what each macro means in case you did not guess :</p><ul>
<li><b>RAND_CASE</b> : special test case which will be run with random numbers, its parameters are<br />
<ul>
<li>the name of the test case</li>
<li>the variable in which we want to store the random values (<code>int tab[]</code>) (WARNING : if you use more than one <b>RAND_CASE</b> or <b>RANGE_CASE</b> in the same section, variable names have to be different)</li>
<li>the size of tab</li>
<li>an unlimited number of ranges that have the form <code>begin, end</code></li>
</ul>
</li>
<li><b>RANGE_CASE</b> : special test case which will be run with with all possible combinations of numbers in defined ranges, its parameters are<br />
<ul>
<li>the name of the test case</li>
<li>the variable in which we want to store the random values (<code>int tab[]</code>) (WARNING : if you use more than one <b>RAND_CASE</b> or <b>RANGE_CASE</b> in the same section, variable names have to be different)</li>
<li>the size of tab</li>
<li>an unlimited number of ranges that have the form <code>begin, end, step</code></li>
</ul>
</li>
<li><b>VALUES_CASE</b> : special test case which will be run for all values in an array, its parameters are<br />
<ul>
<li>the name of the test case</li>
<li>the type of each items in the array</li>
<li>the variable name which will store the value of the current item (it is copied)</li>
<li>the array of values (it needs to be a variable of type static array)</li>
</ul>
</li>
<li><b>COPY</b> : copy a variable of a section in a test case so that the modifications brought by the test case will only be effective in it</li>
<li><b>ONCE</b> : prevent a code inside a section but outside a test case to be called more than once<br />
 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;This problem can occure when you mix up test cases and code not inside test cases</li>
<li><b>INFO</b>, <b>WARNING</b> and <b>ERROR</b>: Add a message to be printed (as info, warning or error) each time a failure occure in the section / case. If those macros are called in a test case, they are effective only inside, else they are effective everywhere in the section. Two macros help configure this tool:<ul>
<li><b>LASSERT_MAX_INFOS</b>: maximum number of times those macros can be called in a section (called in a test case count as called in the section in this case, for optimization purposes)</li>
<li><b>LASSERT_MAX_INFO_LENGTH</b>: maximum length of the message which can be put in those macros, once it has been formated.</li>
</ul>
</li>
</ul>
<p><b>NOTES:</b></p><ul>
<li>You can set the random function using <code>LASSERT_set_rand_function</code>. The function needs to have the following prototype <code>int (*) (void)</code>.</li>
<li><b>INFO</b>, <b>ERROR</b> and <b>WARNING</b> format the string on call, and not on assertion failure.</li>
</ul>
<h3>Events</h3>
<p>You can use five functions to catch five events and do something accordingly using those functions:</p><ul>
<li><code>void LASSERT_on_section_begin(void (*)(const char * sectionName))</code>: call each time a section begin</li>
<li><code>void LASSERT_on_section_end(void (*)(const char * sectionName))</code>: call each time a section ends</li>
<li><code>void LASSERT_on_case_begin(void (*)(const char * caseName))</code>: call each time a case begin</li>
<li><code>void LASSERT_on_case_end(void (*)(const char * caseName))</code>: call each time a section ends</li>
<li><code>void LASSERT_on_assertion_failure((void (*)(char isInCase, const char * caseOrSectionName))</code> calls each time an assertion fails</li>
</ul>
<div class="fragment"><div class="line"><span class="preprocessor">#define LASSERT_MAIN</span></div><div class="line"><span class="preprocessor">#include &quot;../../LAssert.h&quot;</span></div><div class="line"></div><div class="line"><span class="keywordtype">void</span> event_begin_name(<span class="keyword">const</span> <span class="keywordtype">char</span> * name){</div><div class="line">    printf(<span class="stringliteral">&quot;begin %s\n&quot;</span>, name);</div><div class="line">}</div><div class="line"><span class="keywordtype">void</span> event_end_name(<span class="keyword">const</span> <span class="keywordtype">char</span> * name){</div><div class="line">    printf(<span class="stringliteral">&quot;end %s\n&quot;</span>, name);</div><div class="line">}</div><div class="line"><span class="keywordtype">void</span> event_failure(<span class="keywordtype">char</span> isInCase, <span class="keyword">const</span> <span class="keywordtype">char</span> * name){</div><div class="line">    printf(<span class="stringliteral">&quot;Failure in %s --- is in case ? %d\n&quot;</span>, name, isInCase);</div><div class="line">}</div><div class="line">TEST_SECTION(<span class="stringliteral">&quot;set event init&quot;</span>){</div><div class="line">    <a class="code" href="LAssert_8h.html#a3bf2b81d6addbfdb65c3cc143f6fb8b8">LASSERT_on_section_begin</a>(event_begin_name);</div><div class="line">}</div><div class="line">TEST_SECTION(<span class="stringliteral">&quot;redefined event behavior&quot;</span>){</div><div class="line">    <a class="code" href="LAssert_8h.html#a3bf2b81d6addbfdb65c3cc143f6fb8b8">LASSERT_on_section_begin</a>(NULL);</div><div class="line">    <a class="code" href="LAssert_8h.html#ae2817360489b995fe4f2a6f06729e713">LASSERT_on_section_end</a>(event_end_name);</div><div class="line">    <a class="code" href="LAssert_8h.html#a6819c126a2b83210cb7a312b559fd9c2">LASSERT_on_case_begin</a>(event_begin_name);</div><div class="line">    <a class="code" href="LAssert_8h.html#a43c2716c7c57967651b6f3479fa16501">LASSERT_on_case_end</a>(event_end_name);</div><div class="line">    <a class="code" href="LAssert_8h.html#aac49d86d830cf5490ad4f180f1afcd02">LASSERT_on_assertion_failure</a>(event_failure);</div><div class="line"></div><div class="line">    <a class="code" href="LAssert_8h.html#a52a9de102c9503a0a99c8df2323d1c61">TEST_CASE</a>(<span class="stringliteral">&quot;test case&quot;</span>){</div><div class="line">        REQUIRE(0);</div><div class="line">    }</div><div class="line"></div><div class="line">    <a class="code" href="LAssert_8h.html#a13a096d4b31febb9db165fe0d3b2c3c1">RAND_CASE</a>(<span class="stringliteral">&quot;rand case&quot;</span>, tab1, 1, 1, 1, 10){</div><div class="line">    }</div><div class="line"></div><div class="line">    <a class="code" href="LAssert_8h.html#a7afbcd22f6153ec8a1c0d5b3a35d156c">RANGE_CASE</a>(<span class="stringliteral">&quot;range case&quot;</span>, tab2, 1, 0, 1, 1){</div><div class="line">    }</div><div class="line"></div><div class="line">    REQUIRE(0);</div><div class="line">}</div><div class="line">TEST_SECTION(<span class="stringliteral">&quot;set event deinit&quot;</span>){</div><div class="line">    <a class="code" href="LAssert_8h.html#ae2817360489b995fe4f2a6f06729e713">LASSERT_on_section_end</a>(NULL);</div><div class="line">    <a class="code" href="LAssert_8h.html#a6819c126a2b83210cb7a312b559fd9c2">LASSERT_on_case_begin</a>(NULL);</div><div class="line">    <a class="code" href="LAssert_8h.html#a43c2716c7c57967651b6f3479fa16501">LASSERT_on_case_end</a>(NULL);</div><div class="line">    <a class="code" href="LAssert_8h.html#aac49d86d830cf5490ad4f180f1afcd02">LASSERT_on_assertion_failure</a>(NULL);</div><div class="line">}</div></div><!-- fragment --><h3>Disabling allocation</h3>
<p>With those tools, you can render allocation functions to return <code>NULL</code> whenever they are called. You have to do three modifications for that:</p><ul>
<li>You need to call a function in your code (see example below)</li>
<li>You need to define the macro <code>LASSERT_CUSTOM_ALLOC</code> before including <code><a class="el" href="LAssert_8h.html" title="header only Unitary Test Tools in C ">LAssert.h</a></code></li>
<li>You need to link <code>libLAssert_alloc.so</code> shared library (built using <code>make</code> in the main LAssert folder) and using <code>-Wl,-rpath,/path/to/folder/containing/libLAssert_alloc.so -L/same/path -lLAssert_alloc -ldl</code></li>
</ul>
<div class="fragment"><div class="line"><span class="preprocessor">#define LASSERT_MAIN</span></div><div class="line"><span class="preprocessor">#define LASSERT_CUSTOM_ALLOC</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="LAssert_8h.html">LAssert.h</a>&quot;</span></div><div class="line"></div><div class="line">TEST_SECTION(alloc_disabled){</div><div class="line">    LAssert_alloc(1); <span class="comment">// lock allocation</span></div><div class="line">    <span class="keywordtype">int</span> * i = (<span class="keywordtype">int</span>*)malloc(<span class="keyword">sizeof</span>(*i));</div><div class="line">    REQUIRE(!i);</div><div class="line"></div><div class="line">    LAssert_alloc(0); <span class="comment">// unlock allocation</span></div><div class="line">    i = (<span class="keywordtype">int</span>*)malloc(<span class="keyword">sizeof</span>(*i));</div><div class="line">    REQUIRE_NOT_NULL(i);</div><div class="line">    free(i);</div><div class="line">}</div></div><!-- fragment --><p> <b>NOTES:</b></p><ul>
<li>If <code>LASSERT_CUSTOM_ALLOC</code> is not defined, you do not need all this set up.</li>
<li>You can use your own dynamic library to override allocation functions by defining the macro <b>LASSERT_LOCK_LIBRARY</b> with a constant string containing the name of your library.</li>
</ul>
<h3>Performance testing</h3>
<p>You can run an algorithm with a timeout (in seconds). If the timeout is reached before the algorithm ends, the test is considered as failing. You can do as follow: </p><div class="fragment"><div class="line"><span class="preprocessor">#include LASSERT_MAIN</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="LAssert_8h.html">LAssert.h</a>&quot;</span></div><div class="line"></div><div class="line">TEST_SECTION(perfo_test){</div><div class="line">    <a class="code" href="LAssert_8h.html#a52a9de102c9503a0a99c8df2323d1c61">TEST_CASE</a>(inside_case_ok){</div><div class="line">        PERFORMANCE(1){</div><div class="line">            PERFO_EXIT;</div><div class="line">        }</div><div class="line">    }</div><div class="line"></div><div class="line">    <a class="code" href="LAssert_8h.html#a52a9de102c9503a0a99c8df2323d1c61">TEST_CASE</a>(inside_case_ko){</div><div class="line">        PERFORMANCE(1){</div><div class="line">            <span class="keywordflow">while</span>(1);</div><div class="line">            PERFO_EXIT;</div><div class="line">        }</div><div class="line">    }</div><div class="line"></div><div class="line">    PERFORMANCE(1){</div><div class="line">        PERFO_EXIT;</div><div class="line">    }</div><div class="line"></div><div class="line">    PERFORMANCE(1){</div><div class="line">        <span class="keywordflow">while</span>(1);</div><div class="line">        PERFO_EXIT;</div><div class="line">    }</div><div class="line">}</div></div><!-- fragment --><p> <b>NOTES:</b></p><ul>
<li>You <em>need</em> to end the <code>PERFORMANCE</code> block with the <code>PERFO_EXIT</code> macro. </li>
</ul>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
